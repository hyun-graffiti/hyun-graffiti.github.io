<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.5"/><meta name="description" content="데이터베이스 읽기 요청이 많은 경우 활용할 수 있는 RDS 읽기 전용 복제본 사용 경험기를 풀어봤습니다." data-gatsby-head="true"/><meta name="viewport" content="width=device-width, initial-scale=1.0" data-gatsby-head="true"/><meta http-equiv="Content-Type" content="text/html;charset=UTF-8" data-gatsby-head="true"/><meta property="og:type" content="website" data-gatsby-head="true"/><meta property="og:title" content="AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기" data-gatsby-head="true"/><meta property="og:description" content="데이터베이스 읽기 요청이 많은 경우 활용할 수 있는 RDS 읽기 전용 복제본 사용 경험기를 풀어봤습니다." data-gatsby-head="true"/><meta property="og:image" content="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png" data-gatsby-head="true"/><meta property="og:url" content="https://hyun-graffiti.github.io/traffic-distribution-experience-with-aws-rds-read-replica" data-gatsby-head="true"/><meta property="og:site_name" content="AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기" data-gatsby-head="true"/><meta name="twitter:card" content="summary" data-gatsby-head="true"/><meta name="twitter:title" content="AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기" data-gatsby-head="true"/><meta name="twitter:description" content="데이터베이스 읽기 요청이 많은 경우 활용할 수 있는 RDS 읽기 전용 복제본 사용 경험기를 풀어봤습니다." data-gatsby-head="true"/><meta name="twitter:image" content="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png" data-gatsby-head="true"/><meta name="twitter:site" content="@사용자이름" data-gatsby-head="true"/><meta name="twitter:creator" content="@사용자이름" data-gatsby-head="true"/><style data-href="/styles.45a02be8c27400115ebb.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:0 0;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style data-styled="" data-styled-version="6.1.11">.bRRioO{display:flex;justify-content:space-between;align-items:center;height:80px;}/*!sc*/
@media (max-width:768px){.bRRioO{height:60px;}}/*!sc*/
data-styled.g1[id="Header__Wrapper-sc-1hc8kyb-0"]{content:"bRRioO,"}/*!sc*/
.fyhDxH{font-size:15px;font-weight:700;text-decoration:none;color:inherit;}/*!sc*/
data-styled.g2[id="Header__Title-sc-1hc8kyb-1"]{content:"fyhDxH,"}/*!sc*/
.fwfjbJ{display:flex;gap:15px;font-size:25px;}/*!sc*/
.fwfjbJ>a{display:flex;color:initial;}/*!sc*/
@media (max-width:768px){.fwfjbJ{font-size:20px;}}/*!sc*/
data-styled.g3[id="Header__Menu-sc-1hc8kyb-2"]{content:"fwfjbJ,"}/*!sc*/
.llkBPa{display:grid;place-items:center;margin-top:auto;padding:50px 0;font-size:15px;text-align:center;line-height:1.5;}/*!sc*/
@media (max-width:768px){.llkBPa{font-size:12px;}}/*!sc*/
data-styled.g4[id="Footer__Wrapper-sc-4zz2gn-0"]{content:"llkBPa,"}/*!sc*/
*{margin:0;padding:0;box-sizing:border-box;font-family:'Pretendard';}/*!sc*/
html,body,#___gatsby,#gatsby-focus-wrapper{min-height:100%;height:100%;}/*!sc*/
data-styled.g5[id="sc-global-hypAFd1"]{content:"sc-global-hypAFd1,"}/*!sc*/
.gQENhM{display:flex;flex-direction:column;width:1024px;min-height:100%;margin:0 auto;}/*!sc*/
@media (max-width:1024px){.gQENhM{width:100%;padding:0 20px;}}/*!sc*/
@media (max-width:768px){.gQENhM{padding:0 15px;}}/*!sc*/
data-styled.g6[id="Layout__Wrapper-sc-1nh093c-0"]{content:"gQENhM,"}/*!sc*/
.kWYRbG{margin:80px 0;}/*!sc*/
@media (max-width:1024px){.kWYRbG{margin:50px 0;}}/*!sc*/
data-styled.g7[id="Layout__Contents-sc-1nh093c-1"]{content:"kWYRbG,"}/*!sc*/
.kBlDjr{position:relative;overflow:hidden;display:flex;flex-direction:column;justify-content:flex-end;gap:20px;aspect-ratio:16/9;padding:50px;border-radius:20px;}/*!sc*/
@media (max-width:1024px){.kBlDjr{padding:30px;gap:15px;}}/*!sc*/
@media (max-width:768px){.kBlDjr{padding:20px;gap:10px;border-radius:10px;}}/*!sc*/
data-styled.g12[id="PostHead__Wrapper-sc-vdj6u6-0"]{content:"kBlDjr,"}/*!sc*/
.ijTGef{display:-webkit-box;max-height:2.4em;overflow:hidden;font-size:30px;font-weight:700;color:#ffffff;text-overflow:ellipsis;word-wrap:break-word;-webkit-line-clamp:2;-webkit-box-orient:vertical;line-height:1.2em;}/*!sc*/
@media (max-width:1024px){.ijTGef{font-size:24px;}}/*!sc*/
@media (max-width:768px){.ijTGef{font-size:18px;}}/*!sc*/
data-styled.g13[id="PostHead__Title-sc-vdj6u6-1"]{content:"ijTGef,"}/*!sc*/
.gsVtCo{display:flex;justify-content:space-between;padding-bottom:15px;border-bottom:1px solid #ffffff;font-size:15px;font-weight:300;color:#ffffff;}/*!sc*/
@media (max-width:1024px){.gsVtCo{padding-bottom:10px;font-size:13px;}}/*!sc*/
@media (max-width:768px){.gsVtCo{padding-bottom:8px;font-size:11px;}}/*!sc*/
data-styled.g14[id="PostHead__Information-sc-vdj6u6-2"]{content:"gsVtCo,"}/*!sc*/
.dWJGbr{display:flex;gap:7px;}/*!sc*/
data-styled.g15[id="PostHead__Category-sc-vdj6u6-3"]{content:"dWJGbr,"}/*!sc*/
.hgZHAP{position:absolute;top:0;left:0;z-index:-1;width:100%;height:100%;}/*!sc*/
.hgZHAP:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:linear-gradient( 180deg,rgba(0,0,0,0.05) 0%,rgba(0,0,0,0.9) 130% );}/*!sc*/
data-styled.g16[id="PostHead__Thumbnail-sc-vdj6u6-4"]{content:"hgZHAP,"}/*!sc*/
.hopqoZ{padding:2px 5px;border-radius:3px;font-family:'Nanum Gothic Coding',monospace;background:#f1f3f5;}/*!sc*/
data-styled.g17[id="Code__InlineCode-sc-1eu0s92-0"]{content:"hopqoZ,"}/*!sc*/
.bHyjBI *{font-family:'Nanum Gothic Coding',monospace!important;}/*!sc*/
data-styled.g18[id="Code__BlockCode-sc-1eu0s92-1"]{content:"bHyjBI,"}/*!sc*/
.gUrOKg{margin-left:20px;padding:30px 0;}/*!sc*/
data-styled.g19[id="OrderedList__List-sc-6ehqsg-0"]{content:"gUrOKg,"}/*!sc*/
.dFOGjk{font-size:20px;font-weight:700;margin-bottom:30px;}/*!sc*/
*+.dFOGjk{margin-top:80px;}/*!sc*/
hr+.dFOGjk{margin-top:0;}/*!sc*/
@media (max-width:768px){.dFOGjk{font-size:17px;}}/*!sc*/
data-styled.g24[id="Heading__HEADING_3-sc-1y1yzia-2"]{content:"dFOGjk,"}/*!sc*/
.bTSwbP{width:100%;margin:30px 0;}/*!sc*/
.Image__Component-sc-15t0s6v-0+.Image__Component-sc-15t0s6v-0{margin:-20px 0 30px 0;}/*!sc*/
data-styled.g25[id="Image__Component-sc-15t0s6v-0"]{content:"bTSwbP,"}/*!sc*/
.hWLRnp{color:#4263eb;text-decoration:underline;}/*!sc*/
data-styled.g26[id="Link__Component-sc-1a7rtco-0"]{content:"hWLRnp,"}/*!sc*/
.bRuzix{border:1px solid rgba(0,0,0,0.5);margin:80px 0;}/*!sc*/
data-styled.g27[id="HorizontalRule__Component-sc-klq43-0"]{content:"bRuzix,"}/*!sc*/
.hbKfdz{position:sticky;top:100px;width:100%;}/*!sc*/
@media (max-width:768px){.hbKfdz{display:none;}}/*!sc*/
data-styled.g28[id="TableOfContents__Wrapper-sc-1s52ybk-0"]{content:"hbKfdz,"}/*!sc*/
.hdFmsr{padding-bottom:20px;border-bottom:1px solid #000000;font-size:15px;font-weight:600;}/*!sc*/
data-styled.g29[id="TableOfContents__Title-sc-1s52ybk-1"]{content:"hdFmsr,"}/*!sc*/
.fympMG{display:grid;grid-gap:10px;margin-top:20px;}/*!sc*/
data-styled.g30[id="TableOfContents__Items-sc-1s52ybk-2"]{content:"fympMG,"}/*!sc*/
.esiyNY{padding-left:0px;font-size:13px;font-weight:300;color:rgba(30,31,33,0.5);cursor:pointer;text-decoration:none;transition:0.1s all;}/*!sc*/
data-styled.g31[id="TableOfContents__Item-sc-1s52ybk-3"]{content:"esiyNY,"}/*!sc*/
.hkklym{position:relative;display:grid;grid-template-columns:1fr 220px;grid-gap:30px;justify-content:space-between;align-items:flex-start;padding-top:100px;}/*!sc*/
@media (max-width:768px){.hkklym{grid-template-columns:1fr;padding-top:60px;}}/*!sc*/
data-styled.g32[id="PostBody__Wrapper-sc-1o2mpwe-0"]{content:"hkklym,"}/*!sc*/
.gUlYrB{overflow:auto;display:flex;flex-direction:column;gap:100px;font-size:16px;line-height:2;word-break:break-word;}/*!sc*/
@media (max-width:768px){.gUlYrB{gap:50px;font-size:14px;line-height:1.8;}}/*!sc*/
data-styled.g33[id="PostBody__Content-sc-1o2mpwe-1"]{content:"gUlYrB,"}/*!sc*/
</style><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="canonical" href="https://hyun-graffiti.github.io/traffic-distribution-experience-with-aws-rds-read-replica/" data-baseprotocol="https:" data-basehost="hyun-graffiti.github.io"/><link rel="sitemap" type="application/xml" href="/sitemap-index.xml"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-8XQN5D92GD"></script><script>
    window.GATSBY_GTAG_PLUGIN_GA_TRACKING_ID = (
      'G-8XQN5D92GD'
    );
    window.GATSBY_GTAG_PLUGIN_ANONYMIZE = false;

    var options = {
      send_page_view: false
    };
    if (false) {
      options.anonymize_ip = true;
    }

    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    window.gtag = gtag;
    gtag('js', new Date());
    gtag('config', 'G-8XQN5D92GD', options);
  </script><link rel="stylesheet" as="style" crossorigin="anonymous" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic+Coding&amp;display=swap" rel="stylesheet"/><title data-gatsby-head="true">AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="Layout__Wrapper-sc-1nh093c-0 gQENhM"><div class="Header__Wrapper-sc-1hc8kyb-0 bRRioO"><a class="Header__Title-sc-1hc8kyb-1 fyhDxH" href="/">Developer Hyun</a><div class="Header__Menu-sc-1hc8kyb-2 fwfjbJ"><a href="#" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0 1 38.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"></path></svg></a><a href="#" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M512 306.9c-113.5 0-205.1 91.6-205.1 205.1S398.5 717.1 512 717.1 717.1 625.5 717.1 512 625.5 306.9 512 306.9zm0 338.4c-73.4 0-133.3-59.9-133.3-133.3S438.6 378.7 512 378.7 645.3 438.6 645.3 512 585.4 645.3 512 645.3zm213.5-394.6c-26.5 0-47.9 21.4-47.9 47.9s21.4 47.9 47.9 47.9 47.9-21.3 47.9-47.9a47.84 47.84 0 0 0-47.9-47.9zM911.8 512c0-55.2.5-109.9-2.6-165-3.1-64-17.7-120.8-64.5-167.6-46.9-46.9-103.6-61.4-167.6-64.5-55.2-3.1-109.9-2.6-165-2.6-55.2 0-109.9-.5-165 2.6-64 3.1-120.8 17.7-167.6 64.5C132.6 226.3 118.1 283 115 347c-3.1 55.2-2.6 109.9-2.6 165s-.5 109.9 2.6 165c3.1 64 17.7 120.8 64.5 167.6 46.9 46.9 103.6 61.4 167.6 64.5 55.2 3.1 109.9 2.6 165 2.6 55.2 0 109.9.5 165-2.6 64-3.1 120.8-17.7 167.6-64.5 46.9-46.9 61.4-103.6 64.5-167.6 3.2-55.1 2.6-109.8 2.6-165zm-88 235.8c-7.3 18.2-16.1 31.8-30.2 45.8-14.1 14.1-27.6 22.9-45.8 30.2C695.2 844.7 570.3 840 512 840c-58.3 0-183.3 4.7-235.9-16.1-18.2-7.3-31.8-16.1-45.8-30.2-14.1-14.1-22.9-27.6-30.2-45.8C179.3 695.2 184 570.3 184 512c0-58.3-4.7-183.3 16.1-235.9 7.3-18.2 16.1-31.8 30.2-45.8s27.6-22.9 45.8-30.2C328.7 179.3 453.7 184 512 184s183.3-4.7 235.9 16.1c18.2 7.3 31.8 16.1 45.8 30.2 14.1 14.1 22.9 27.6 30.2 45.8C844.7 328.7 840 453.7 840 512c0 58.3 4.7 183.2-16.2 235.8z"></path></svg></a><a href="#" target="_blank"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zM349.3 793.7H230.6V411.9h118.7v381.8zm-59.3-434a68.8 68.8 0 1 1 68.8-68.8c-.1 38-30.9 68.8-68.8 68.8zm503.7 434H675.1V608c0-44.3-.8-101.2-61.7-101.2-61.7 0-71.2 48.2-71.2 98v188.9H423.7V411.9h113.8v52.2h1.6c15.8-30 54.5-61.7 112.3-61.7 120.2 0 142.3 79.1 142.3 181.9v209.4z"></path></svg></a></div></div><div class="Layout__Contents-sc-1nh093c-1 kWYRbG"><div class="PostHead__Wrapper-sc-vdj6u6-0 kBlDjr"><div class="PostHead__Title-sc-vdj6u6-1 ijTGef">AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기</div><div class="PostHead__Information-sc-vdj6u6-2 gsVtCo"><div class="PostHead__Category-sc-vdj6u6-3 dWJGbr"><div>#<!-- -->Infrastructure</div><div>#<!-- -->AWS</div></div><div>2023-09-29</div></div><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained PostHead__Thumbnail-sc-vdj6u6-4 hgZHAP"><div style="max-width:1000px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;586&#x27;%20width=&#x27;1000&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=192&amp;h=113&amp;q=50&amp;fm=webp 192w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=384&amp;h=225&amp;q=50&amp;fm=webp 384w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=768&amp;h=450&amp;q=50&amp;fm=webp 768w" sizes="(min-width: 768px) 768px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 768px) 768px, 100vw" decoding="async" loading="lazy" data-src="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=768&amp;h=450&amp;q=50&amp;fm=png" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=192&amp;h=113&amp;q=50&amp;fm=png 192w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=384&amp;h=225&amp;q=50&amp;fm=png 384w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=768&amp;h=450&amp;q=50&amp;fm=png 768w" alt="AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기"/></picture><noscript><picture><source type="image/webp" srcSet="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=192&amp;h=113&amp;q=50&amp;fm=webp 192w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=384&amp;h=225&amp;q=50&amp;fm=webp 384w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=768&amp;h=450&amp;q=50&amp;fm=webp 768w" sizes="(min-width: 768px) 768px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 768px) 768px, 100vw" decoding="async" loading="lazy" src="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=768&amp;h=450&amp;q=50&amp;fm=png" srcSet="https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=192&amp;h=113&amp;q=50&amp;fm=png 192w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=384&amp;h=225&amp;q=50&amp;fm=png 384w,https://images.ctfassets.net/4fyf4nbljpox/5fHIj7yeeo98RrIUN3bJHi/5b82eca672a88168b7aa154b2df8edac/traffic-distribution-experience-with-aws-rds-read-replica.png?w=768&amp;h=450&amp;q=50&amp;fm=png 768w" alt="AWS RDS 읽기 복제본을 통한 데이터베이스 트래픽 분산 경험기"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div></div><div class="PostBody__Wrapper-sc-1o2mpwe-0 hkklym"><div class="PostBody__Content-sc-1o2mpwe-1 gUlYrB"><div id="content"><h3 id="처음으로-맛본-트래픽-증가-대응-경험_" class="Heading__HEADING_3-sc-1y1yzia-2 dFOGjk">처음으로 맛본 트래픽 증가 대응   경험</h3><p>2023년 1월, 처음으로 오픈한 우리 스타트업의 서비스는 7개월 동안 유저 트래픽이 크게 발생하지 않아 그동안 백엔드 서버 1개, 데이터베이스 1개로도 잘 운영되고 있었습니다.</p><p>하지만 7월 말, 천천히 늘어가던 유저 수가 우리 서비스의 좋은 소식과 함께 갑자기 크게 증가하기 시작했는데 서버와 데이터베이스 1개로만 잘 운영하던 서비스가 엄청나게 느려지기 시작했던 것이었습니다.</p><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained Image__Component-sc-15t0s6v-0 bTSwbP"><div style="max-width:774px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;461&#x27;%20width=&#x27;774&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=194&amp;h=116&amp;q=50&amp;fm=webp 194w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=387&amp;h=231&amp;q=50&amp;fm=webp 387w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=774&amp;h=461&amp;q=50&amp;fm=webp 774w" sizes="(min-width: 774px) 774px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 774px) 774px, 100vw" decoding="async" loading="lazy" data-src="https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=774&amp;h=461&amp;q=50&amp;fm=png" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=194&amp;h=116&amp;q=50&amp;fm=png 194w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=387&amp;h=231&amp;q=50&amp;fm=png 387w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=774&amp;h=461&amp;q=50&amp;fm=png 774w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=194&amp;h=116&amp;q=50&amp;fm=webp 194w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=387&amp;h=231&amp;q=50&amp;fm=webp 387w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=774&amp;h=461&amp;q=50&amp;fm=webp 774w" sizes="(min-width: 774px) 774px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 774px) 774px, 100vw" decoding="async" loading="lazy" src="https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=774&amp;h=461&amp;q=50&amp;fm=png" srcSet="https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=194&amp;h=116&amp;q=50&amp;fm=png 194w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=387&amp;h=231&amp;q=50&amp;fm=png 387w,https://images.ctfassets.net/4fyf4nbljpox/7kJXGaV16GRfErYS4hLQrn/b1235a1dceff42094df5e3a8a5ba68ae/Screenshot_2023-08-01_at_1.07.47_AM.png?w=774&amp;h=461&amp;q=50&amp;fm=png 774w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><p>그 당시 토요일 밤 하필 저는 양양에 놀러 간 상황이었는데, 그때에는 다들 무섭게 쌓여가는 유저 문의를 처리하는데 바빠 당장 인프라 문제에 대응할 수 있는 개발 인력이 없었습니다.</p><p>엎친 데 덮친 격으로 끊임없는 유저 문의와 함께 거래 내역이 대략 15,000개가 밀려있는 상황이 발생했었습니다.</p><p>거래 내역이 밀리게 됨에 따라 서비스를 사용하는 유저는 실시간으로 거래 내역 상황을 받아볼 수 없을뿐더러 거래가 밀려 가상 자산을 받지 못하는 상황까지 일어났습니다.</p><p>또한 거래가 발생하게 되면 일일 미션을 달성하게 되어 포인트를 받는 기능이 있는데, 이 또한 계속해서 밀려 제때 포인트를 받지 못해 장애가 발생한 날에만 포인트를 받지 못하는 경우도 생길 수 있었습니다.</p><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained Image__Component-sc-15t0s6v-0 bTSwbP"><div style="max-width:774px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;249&#x27;%20width=&#x27;774&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=194&amp;h=62&amp;q=50&amp;fm=webp 194w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=387&amp;h=125&amp;q=50&amp;fm=webp 387w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=774&amp;h=249&amp;q=50&amp;fm=webp 774w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=1548&amp;h=498&amp;q=50&amp;fm=webp 1548w" sizes="(min-width: 774px) 774px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 774px) 774px, 100vw" decoding="async" loading="lazy" data-src="https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=774&amp;h=249&amp;q=50&amp;fm=png" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=194&amp;h=62&amp;q=50&amp;fm=png 194w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=387&amp;h=125&amp;q=50&amp;fm=png 387w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=774&amp;h=249&amp;q=50&amp;fm=png 774w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=1548&amp;h=498&amp;q=50&amp;fm=png 1548w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=194&amp;h=62&amp;q=50&amp;fm=webp 194w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=387&amp;h=125&amp;q=50&amp;fm=webp 387w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=774&amp;h=249&amp;q=50&amp;fm=webp 774w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=1548&amp;h=498&amp;q=50&amp;fm=webp 1548w" sizes="(min-width: 774px) 774px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 774px) 774px, 100vw" decoding="async" loading="lazy" src="https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=774&amp;h=249&amp;q=50&amp;fm=png" srcSet="https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=194&amp;h=62&amp;q=50&amp;fm=png 194w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=387&amp;h=125&amp;q=50&amp;fm=png 387w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=774&amp;h=249&amp;q=50&amp;fm=png 774w,https://images.ctfassets.net/4fyf4nbljpox/33WVJYB6KkWS1Wvz1Uw2SW/814fdf078a1eb35b7d48e8d2b31d521c/1.png?w=1548&amp;h=498&amp;q=50&amp;fm=png 1548w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained Image__Component-sc-15t0s6v-0 bTSwbP"><div style="max-width:774px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg%20height=&#x27;195&#x27;%20width=&#x27;774&#x27;%20xmlns=&#x27;http://www.w3.org/2000/svg&#x27;%20version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/webp" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=194&amp;h=49&amp;q=50&amp;fm=webp 194w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=387&amp;h=98&amp;q=50&amp;fm=webp 387w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=774&amp;h=195&amp;q=50&amp;fm=webp 774w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=1548&amp;h=390&amp;q=50&amp;fm=webp 1548w" sizes="(min-width: 774px) 774px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 774px) 774px, 100vw" decoding="async" loading="lazy" data-src="https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=774&amp;h=195&amp;q=50&amp;fm=png" data-srcset="https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=194&amp;h=49&amp;q=50&amp;fm=png 194w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=387&amp;h=98&amp;q=50&amp;fm=png 387w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=774&amp;h=195&amp;q=50&amp;fm=png 774w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=1548&amp;h=390&amp;q=50&amp;fm=png 1548w" alt=""/></picture><noscript><picture><source type="image/webp" srcSet="https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=194&amp;h=49&amp;q=50&amp;fm=webp 194w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=387&amp;h=98&amp;q=50&amp;fm=webp 387w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=774&amp;h=195&amp;q=50&amp;fm=webp 774w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=1548&amp;h=390&amp;q=50&amp;fm=webp 1548w" sizes="(min-width: 774px) 774px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 774px) 774px, 100vw" decoding="async" loading="lazy" src="https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=774&amp;h=195&amp;q=50&amp;fm=png" srcSet="https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=194&amp;h=49&amp;q=50&amp;fm=png 194w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=387&amp;h=98&amp;q=50&amp;fm=png 387w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=774&amp;h=195&amp;q=50&amp;fm=png 774w,https://images.ctfassets.net/4fyf4nbljpox/4IkVq7rN67ajYwL4cF0k5I/f670a886529f0ea8bd6d5fb76de6778d/2.png?w=1548&amp;h=390&amp;q=50&amp;fm=png 1548w" alt=""/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><p>그래서 그 당시 EC2 인스턴스의 CPU와 메모리 사용률이 크게 증가하고, 데이터베이스 CPU 사용률이 거의 100퍼센트에 도달했었습니다.</p><p>그렇게 정말 급하게 엄청난 트래픽의 증가에 대응해야하는 때를 마주하게 되었습니다.</p><h3 id="백엔드-서버는-금방-대응하는데-데이터베이스는..?_" class="Heading__HEADING_3-sc-1y1yzia-2 dFOGjk">백엔드 서버는 금방 대응하는데 데이터베이스는..?</h3><p>백엔드 서버는 당시 AWS ECS를 통해 관리되고 있었기에 손쉽게 EC2 인스턴스 사양 증가 및 Auto Scaling 설정을 조정하여 서버가 6대까지 실행되도록 설정했습니다.</p><p>그렇게 로드 밸런서를 통해 서버의 트래픽은 안정적으로 분산되도록 했지만 그다음 관문인 데이터베이스가 문제였습니다.</p><p>처음으로 데이터베이스의 CPU 사용률을 저렇게 높게 유지시키는 SQL 문을 찾아봤었는데, 포인트를 지급할 때 중복 지급을 막기 위해 그동안의 내역을 조회하는 쿼리문이 문제였습니다.</p><p>쿼리 최적화 또는 캐시 처리를 해야 했던 상황이지만, 아직 제대로 된 테스트 코드가 존재하지 않았고 이 부분은 유저의 자산과 직결되는 문제라 중요한 부분이었기에 추후 충분한 테스트와 함께 개선해야 한다 생각해서 미뤄두었습니다.</p><p>일단 백엔드 코드 개선 말고 인프라 부분에서 개선할 수 있는 방법을 찾아 보았는데, 예전부터 찾아보고 있었던 Auto Scaling을 통해 자동으로 트래픽 분산을 지원해 주 는 AWS RDS Aurora가 떠올랐지만, 그 당시 급한 상황에서 충분한 테스트도 거치지 않고서 섣부르게 도입하는 건 엄청난 도박이었습니다.</p><h3 id="RDS-읽기-전용-복제본은-어떨까_" class="Heading__HEADING_3-sc-1y1yzia-2 dFOGjk">RDS 읽기 전용 복제본은 어떨까</h3><p>그렇게 결국 인프라 단에서의 남은 방법은 RDS 읽기 전용 복제본을 통한 방법밖에 없었습니다.</p><p>하지만 읽기 전용 복제본을 만들어서 적용하는 방법은 처음이었지만 너무나 다행히도 이미 블로그 포스팅이나 예시가 꽤 많이 나와 있었기 때문에 어려운 점이 없었습니다.</p><p>게다가 지금 사용하고 있는 ORM 라이브러리인 Sequelize에서도 읽기 전용 복제본 설정을 손쉽게 할 수 있어서 빠른 시간 내로 트래픽 증가 대응이 가능했습니다.</p><p>그래서 당시 급한 상황 속에서 정말 자세하게 찾아보지는 못했지만 빠르게 읽기 전용 복제본을 넉넉하게 만들어서 프로덕션 서버로 배포해 데이터베이스 부하를 잘 분산시켰습니다.</p><p>이런 새로운 경험 이후에 RDS 읽기 전용 복제본에 대해 여러 포스팅을 찾아봤었는데 볼수록 너무나도 괜찮은 기능이라고 생각했는데, 이유는 아래와 같습니다.</p><ol class="OrderedList__List-sc-6ehqsg-0 gUrOKg"><li><p><b>RDS 인스턴스 당 읽기 전용 복제본은 최대 5개까지 생성할 수 있다.</b></p><p>필요에 따라 언제든 손쉽게 읽기 전용 복제본의 수를 늘리고 줄일 수 있습니다.</p></li><li><p><b>읽기 전용 복제본은 일반 RDS 인스턴스로 승격할 수 있다.</b></p><p>데이터베이스 샤딩, 장애 복구 등의 이유로 독립된 데이터베이스로 분리할 수 있습니다.</p></li><li><p><b>데이터베이스 엔진에 따라 읽기 전용 복제본에 쓰기 기능이 가능하도록 설정이 가능하다.</b></p><p>아쉽게도 나는 물리적 복제 방식이 적용된 PostgreSQL을 사용하고 있어서 쓰기 기능을 사용할 수 없지만 논리적 복제 방식이 적용된 MySQL/MariaDB 같은 경우에는 쓰기 기능을 사용할 수 있다고 합니다.</p></li></ol><p>너무나도 손쉽게 만들 수 있어서 그 당시 상황에서 선택할 수 있는 최선의 방법이었지만, 조금 우려되는 부분도 있었습니다.</p><ol class="OrderedList__List-sc-6ehqsg-0 gUrOKg"><li><p><b>새로운 읽기 전용 복제본의 적용까지 걸리는 시간이 짧은 편은 아니다.</b></p><p>이번과 마찬가지로 갑작스럽게 치솟는 트래픽으로 인해 기존에 생성해 놓았던 읽기 전용 복제본으로도 감당이 안 되는 수준이라면 추가로 증설해서 트래픽 증가에 대응해야 합니다.</p><p>하지만 복제본을 생성하는 시간이 짧지 않은 편이고, 새로 추가된 복제본의 엔드포인트를 Sequelize 레플리카 옵션에 추가하고 서버를 새로 배포해야 하는 과정이 필요합니다.</p><p>결국 이 작업이 완료되기 전까지 계속해서 다운 타임이 길어지는 건데 이런 트래픽 스파이크를 장애 없이 대응하기가 조금 어려울 것 같다고 생각했었습니다.</p></li><li><p><b>마스터 인스턴스에서 처리된 변경 작업이 전파되는 데까지 딜레이가 생길 수 있다.</b></p><p>Standby 인스턴스에 동기적으로 변경 사항을 반영하는 다중 AZ 배포 방식과는 다르게 읽기 전용 복제본에는 비동기적으로 반영이 이루어집니다.</p><p>그래서 변경 사항이 반영되기까지 딜레이가 생길 수도 있었는데, 가상화폐가 오고 가는 시스템에서 딜레이가 길어져 데이터를 제대로 처리하지 못하는 상황이 발생한다면 서비스 신뢰성에 큰 타격을 입히게 됩니다.</p><p>그래서 이 부분은 읽기 전용 복제본을 적용하기 전부터 우려한 부분이었지만, 더 이상 계속해서 길어지는 다운 타임을 지켜  보고만 있을 수는 없었기에 일단 먼저 적용한 후에 모니터링을 진행했었습니다.</p><p>다행히 거의 딜레이가 발생하지 않았었고, 조금 딜레이가 발생하더라도 시간이 엄청 짧았기 때문에 프로덕션 환경을 운영하면서 문제가 발생한 적은 없었습니다.</p></li></ol><h3 id="그래서-만드는-방법은?_" class="Heading__HEADING_3-sc-1y1yzia-2 dFOGjk">그래서 만드는 방법은?</h3><p>해당 글에서는 Node.js 서버에서 Sequelize를 사용하는 환경을 기준으로 설명하고 있는데, Sequelize를 사용하면 RDS 읽기 전용 복제본을 만들고 적용하는 과정이 되게 간단해집니다.</p><p>먼저, AWS RDS 콘솔 페이지에서 읽기 전용 복제본 생성을 희망하는 인스턴스를 선택하고 작업 메뉴의 읽기 전용 복제본 메뉴를 선택합니다.</p><p>해당 메뉴를 선택하면 읽기 전용 복제본 생성 페이지로 이동하게 됩니다.</p><p>저는 포스팅을 위해 제 환경에서 생성 페이지에 접속했을 때 나타나는 기본 설정을 그대로 캡쳐했지만, 필요에 따라 옵션을 다르게 설정할 수도 있습니다.</p><p>그런데 여기서 확인할 수 있는 큰 특징이 2가지 더 보입니다.</p><p>첫 번째는 읽기 전용 복제본의 사양을 마스터 노드와 다르게 설정이 가능하다는 점인데, 마스터 노드보다 더 높은 사양으로 복제본을 운영할 수 있습니다.</p><p>그리고 두 번째는 읽기 전용 복제본 또한 일반적인 RDS 인스턴스와 같이 높은 가용성을 위해 다중 AZ 배포 옵션을 사용할 수 있다는 점입니다.</p><p>이렇게 읽기 전용 복제본을 생성하게 되면 아래와 같이 마스터 노드 아래 복제본이 표시됩니다.</p><p>이제 이렇게 생성한 복제본의 엔드포인트를 Sequelize의 <code class="Code__InlineCode-sc-1eu0s92-0 hopqoZ">replication</code> 옵션에 추가하고 배포해야 합니다.</p><p>Sequelize는 읽 기 및 쓰기 전용 엔드포인트를 구분할 수 있게끔 옵션을 설정할 수 있습니다.</p><p>읽기 전용 복제본을 구성하기 전의 코드는 아래와 같습니다.</p><p><pre class="Code__BlockCode-sc-1eu0s92-1 bHyjBI"><code class="language-typescript">export const sequelize = new Sequelize(
  config.get&lt;string&gt;(&#x27;PG_DATABASE&#x27;),
  config.get&lt;string&gt;(&#x27;PG_USERNAME&#x27;),
  config.get&lt;string&gt;(&#x27;PG_PASSWORD&#x27;),
  {
    host: config.get&lt;string&gt;(&#x27;PG_HOST&#x27;),
    dialect: &#x27;postgres&#x27;,
    port: config.get&lt;number&gt;(&#x27;PG_PORT&#x27;),
    timezone: config.get&lt;string&gt;(&#x27;PG_TIMEZONE&#x27;),
    models: [~~],
  },
)</code></pre></p><p>예시 코드에서는 config 모듈을 통해 환경 변수 파일을 불러오고 있습니다.</p><p>각자 환경에서 작업하는 경우에는 적절하게 데이터베이스 인증값을 넣어서 테스트해야 합니다.</p><p>단일 인스턴스에 접속하기 위해서는 위와 같이 코드를 작성해야 했습니다.</p><p>하지만 여러 읽기 전용 복제본을 추가하기 위해서는 아래와 같이 코드를 변경해야 합니다.</p><p><pre class="Code__BlockCode-sc-1eu0s92-1 bHyjBI"><code class="language-typescript">export const sequelize = new Sequelize({
  dialect: &#x27;postgres&#x27;,
  database: config.get&lt;string&gt;(&#x27;PG_DATABASE&#x27;),
  port: config.get&lt;number&gt;(&#x27;PG_PORT&#x27;),
  timezone: config.get&lt;string&gt;(&#x27;PG_TIMEZONE&#x27;),
  replication: {
    read: [
      { host: config.get&lt;string&gt;(&#x27;PG_HOST_REPLICA_1&#x27;), username, password },
      { host: config.get&lt;string&gt;(&#x27;PG_HOST_REPLICA_2&#x27;), username, password },
      { host: config.get&lt;string&gt;(&#x27;PG_HOST_REPLICA_3&#x27;), username, password },
    ],
    write: { host: config.get&lt;string&gt;(&#x27;PG_HOST&#x27;), username, password },
  },
  models: [~~],
})</code></pre></p><p>위와 같이 replication 옵션을 통해 읽기 전용 복제본을 추가할 수 있고, 쓰기 작업을 위한 마스터 노드 설정까지 손쉽게 할 수 있습니다.</p><p>그런데 위의 코드에서 모든 인스턴스에 대한 패스워드가 동일한 것을 확인할 수 있습니다.</p><p>기본적으로 읽기 전용 복제본 생성 페이지에서는 데이터베이스 암호를 설정하는 부분은 없지만, 생성 후에 변경이 가능합니다.</p><p>이제 이렇게 변경한 코드를 배포하면 RDS 읽기 전용 복제본 추가가 완료됩니다.</p><p></p><hr class="HorizontalRule__Component-sc-klq43-0 bRuzix"/><h3 id="출처_" class="Heading__HEADING_3-sc-1y1yzia-2 dFOGjk">출처</h3><ol class="OrderedList__List-sc-6ehqsg-0 gUrOKg"><li><p>AWS RDS 공식 문서 - DB 인스턴스 읽기 전용 복제본 작업</p><p><a href="https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/USER_ReadRepl.html" target="_blank" rel="noopener noreferrer" class="Link__Component-sc-1a7rtco-0 hWLRnp">https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/USER_ReadRepl.html</a></p></li><li><p>AWS RDS 공식 문서 - Amazon RDS for PostgreSQL의 읽기 전용 복제본 작업</p><p><a href="https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/USER_PostgreSQL.Replication.ReadReplicas.html" target="_blank" rel="noopener noreferrer" class="Link__Component-sc-1a7rtco-0 hWLRnp">https://docs.aws.amazon.com/ko_kr/AmazonRDS/latest/UserGuide/USER_PostgreSQL.Replication.ReadReplicas.html</a></p></li></ol><p></p></div><div></div></div><div class="TableOfContents__Wrapper-sc-1s52ybk-0 hbKfdz"><div class="TableOfContents__Title-sc-1s52ybk-1 hdFmsr">Table of Contents</div><div class="TableOfContents__Items-sc-1s52ybk-2 fympMG"><a class="TableOfContents__Item-sc-1s52ybk-3 esiyNY" href="/traffic-distribution-experience-with-aws-rds-read-replica/#처음으로-맛본-트래픽-증가-대응-경험_">처음으로 맛본 트래픽 증가 대응 경험</a><a class="TableOfContents__Item-sc-1s52ybk-3 esiyNY" href="/traffic-distribution-experience-with-aws-rds-read-replica/#백엔드-서버는-금방-대응하는데-데이터베이스는..?_">백엔드 서버는 금방 대응하는데 데이터베이스는..?</a><a class="TableOfContents__Item-sc-1s52ybk-3 esiyNY" href="/traffic-distribution-experience-with-aws-rds-read-replica/#RDS-읽기-전용-복제본은-어떨까_">RDS 읽기 전용 복제본은 어떨까</a><a class="TableOfContents__Item-sc-1s52ybk-3 esiyNY" href="/traffic-distribution-experience-with-aws-rds-read-replica/#그래서-만드는-방법은?_">그래서 만드는 방법은?</a><a class="TableOfContents__Item-sc-1s52ybk-3 esiyNY" href="/traffic-distribution-experience-with-aws-rds-read-replica/#출처_">출처</a></div></div></div></div><footer class="Footer__Wrapper-sc-4zz2gn-0 llkBPa"><div>Thank You for Visiting My Blog, Have a Good Day 😆</div><div>Copyright © 2023 Developer Hyun</div></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=Test"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'Test', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/traffic-distribution-experience-with-aws-rds-read-replica/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-8112e134085208e23783.js\"],\"component---src-pages-404-tsx\":[\"/component---src-pages-404-tsx-d270ab3c901635ba7b8a.js\"],\"component---src-pages-contentful-post-slug-tsx\":[\"/component---src-pages-contentful-post-slug-tsx-998994161a71c8b340e5.js\"],\"component---src-pages-index-tsx\":[\"/component---src-pages-index-tsx-bc673125c4c4e8820e20.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="10e91823fbdb40eb2415";</script><script src="/webpack-runtime-cc9fda7e9ee627e47d1d.js" async></script><script src="/framework-befbd9c31bfd9c53e074.js" async></script><script src="/d7eeaac4-2636f38c8511c1ce67c2.js" async></script><script src="/app-8112e134085208e23783.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>